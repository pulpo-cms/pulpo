function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}require("turbolinks");var e=t(require("dragula")),r=t(require("rails-ujs")),o=require("stimulus"),i=require("@rails/activestorage"),n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toggleMoreFilters=function(t){t.preventDefault(),this.moreFiltersTarget.classList.toggle("d-none")},e.prototype.submitForm=function(t){"Enter"==t.key&&this.element.submit()},e}(o.Controller);n.targets=["toggleBtn","moreFilters"];var a=require("@uppy/core"),s=(require("@uppy/xhr-upload"),require("@uppy/dashboard")),u=require("uppy-activestorage-upload"),p=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.initialize=function(){var t=this,e=a().use(s,{trigger:this.triggerTarget,target:this.modalTarget});e.use(u,{directUploadUrl:this.data.get("upload-url")}),e.on("complete",function(e){setTimeout(function(){window.location.replace(t.data.get("media-library-path"))},1e3)})},e}(o.Controller);function l(t,e){var r=Object.keys(t).map(function(r){var o=t[r];return t.constructor===Array?r=e+"[]":t.constructor===Object&&(r=e?e+"["+r+"]":r),"object"==typeof o?l(o,r):r+"="+encodeURIComponent(o)});return[].concat.apply([],r).join("&")}p.targets=["trigger","modal"];var d=function(t,e){try{return Promise.resolve(r.ajax({type:"PUT",url:"/admin/reorder/"+t+".json",data:l({ids:e},"")}))}catch(t){return Promise.reject(t)}},c=function(t,e){void 0===e&&(e={});try{return Promise.resolve(r.ajax(Object.assign({type:"GET",url:"/api/v1/media/"+t},e)))}catch(t){return Promise.reject(t)}},g=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var o={direction:{configurable:!0},model:{configurable:!0},draggableIds:{configurable:!0}};return r.prototype.connect=function(){var t=this;this.drake=e({containers:[this.containerTarget],direction:this.direction,mirrorContainer:this.containerTarget,moves:function(t,e,r){return"sortable.handle"==r.dataset.target}}),this.drake.on("drop",function(){return t.onDrop()})},r.prototype.onDrop=function(){var t=this;setTimeout(function(){d(t.model,t.draggableIds)},300)},o.direction.get=function(){return this.data.get("direction")||"vertical"},o.model.get=function(){return this.data.get("model")},o.draggableIds.get=function(){return this.draggableTargets.map(function(t){return t.dataset.id})},Object.defineProperties(r.prototype,o),r}(o.Controller);g.targets=["container","draggable"];var f=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={isEmpty:{configurable:!0},isUploading:{configurable:!0},isUploaded:{configurable:!0},uploadedImageUrl:{configurable:!0},uploadUrl:{configurable:!0},isAttached:{configurable:!0}};return e.prototype.connect=function(){this.isAttached&&(this.isEmpty=!1,this.isUploaded=!0)},e.prototype.upload=function(){var t=this;Array.from(this.inputTarget.files).forEach(function(e){return t.doUpload(e)}),this.inputTarget.value=null},e.prototype.doUpload=function(t){var e=this;this.isEmpty=!1,this.isUploading=!0,new i.DirectUpload(t,this.uploadUrl).create(function(t,r){if(t)alert("Something went wrong");else{var o=document.createElement("input"),i=e;o.setAttribute("type","hidden"),o.setAttribute("value",r.signed_id),o.name=e.inputTarget.name,e.element.appendChild(o);c(r.id,{success:function(t){i.uploadedImageUrl=t.data.attributes.sizes.original}});e.isUploading=!1,e.isUploaded=!0}})},r.isEmpty.set=function(t){this._isEmpty=t,t?this.inputTarget.classList.remove("d-none"):this.inputTarget.classList.add("d-none")},r.isUploading.set=function(t){this._isUploading=t,t?this.progressTarget.classList.remove("d-none"):this.progressTarget.classList.add("d-none")},r.isUploaded.set=function(t){this._isUploaded=t,t?this.uploadedTarget.classList.remove("d-none"):this.uploadedTarget.classList.add("d-none")},r.uploadedImageUrl.set=function(t){this.uploadedImgTarget.setAttribute("src",t)},r.isUploading.get=function(){return this._isUploading},r.isUploaded.get=function(){return this._isUploaded},r.uploadUrl.get=function(){return this.data.get("upload-url")},r.isAttached.get=function(){return"true"==this.data.get("attached")},Object.defineProperties(e.prototype,r),e}(o.Controller);f.targets=["input","progress","uploaded","uploadedImg"],exports.SearchFormController=n,exports.MediaLibraryUploadBtnController=p,exports.SortableController=g,exports.ImageInputController=f;
//# sourceMappingURL=index.js.map
